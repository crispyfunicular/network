Xarxes neurals¶
neurals¶ Return
Return to
to Artificial
Artificial Intelligence
Intelligence Lab
Lab Notebooks
Notebooks Autors
Autors Pablo
Pablo Gay
Gay Beatriz
Beatriz López
López Data
Data 2017
2017 04
04 03
03 In
In Aquesta
Aquesta linia
linia fa
fa que
que les
les grafiques
grafiques surtin
surtin a
a la
la llibreta
llibreta executar
executar pero
pero no
no toca
toca r
r matplotlib
matplotlib inline
inline Material
Material i
i entorn
entorn de
de treball¶
treball¶ 1
1 Descarregar
Descarregar l
l instal·lador
instal·lador de
de l
l entorn
entorn de
de treball
treball Jupyter
Jupyter WinPython
WinPython 2
2 Executa
Executa i
i espera
espera la
la descompressió
descompressió de
de l
l instal·lador
instal·lador 3
3 Instal·lar
Instal·lar deixant
deixant totes
totes les
les opcions
opcions predeterminades
predeterminades Per
Per defecte
defecte el
el directori
directori d
d instal·lació
instal·lació serà
serà el
el mateix
mateix que
que el
el directori
directori de
de descàrrega
descàrrega 4
4 Obrir
Obrir la
la carpeta
carpeta on
on acabeu
acabeu d
d instal·lar
instal·lar Jupyter
Jupyter WinPython
WinPython després
després el
el directori
directori notebooks
notebooks 5
5 Descarregueu
Descarregueu i
i descomprimiu
descomprimiu el
el contingut
contingut d
d aquesta
aquesta pràctica
pràctica aquí
aquí 6
6 Des
Des del
del directori
directori d
d instal·lació
instal·lació executar
executar el
el fitxer
fitxer Jupyter
Jupyter Notebook
Notebook exe
exe 7
7 Navegar
Navegar fins
fins Lab
Lab 03
03 Deep
Deep Learning
Learning Xarxes
Xarxes neurals
neurals Introducció¶
Introducció¶ Les
Les xarxes
xarxes neurals
neurals són
són un
un conjunt
conjunt de
de neurones
neurones artificials
artificials interconnectades
interconnectades que
que utilitzen
utilitzen un
un model
model matemàtic
matemàtic de
de processament
processament de
de dades
dades basat
basat en
en una
una aproximació
aproximació connexionista
connexionista per
per a
a la
la computació
computació Es
Es troben
troben dins
dins del
del camp
camp de
de la
la Intel·ligència
Intel·ligència Artificial
Artificial Subsimbòlica
Subsimbòlica La
La perspectiva
perspectiva subsimbòlica
subsimbòlica estudia
estudia els
els mecanismes
mecanismes dels
dels sistemes
sistemes nerviosos
nerviosos concretament
concretament en
en aquest
aquest cas
cas del
del cervell
cervell així
així com
com la
la seva
seva estructura
estructura funcionament
funcionament i
i característiques
característiques lògiques
lògiques amb
amb la
la intenció
intenció de
de dissenyar
dissenyar programes
programes que
que s’adaptin
s’adaptin i
i generin
generin sistemes
sistemes capaços
capaços de
de resoldre
resoldre problemes
problemes Els
Els mètodes
mètodes d’aprenentatge
d’aprenentatge basats
basats en
en xarxes
xarxes neurals
neurals proporcionen
proporcionen una
una manera
manera robusta
robusta per
per aproximar
aproximar funcions
funcions reals
reals discretes
discretes o
o vectorials
vectorials En
En particular
particular per
per cert
cert tipus
tipus de
de problemes
problemes com
com els
els d’interpretar
d’interpretar les
les dades
dades provenint
provenint d’un
d’un sensor
sensor les
les xarxes
xarxes neurals
neurals són
són dels
dels mètodes
mètodes més
més efectius
efectius coneguts
coneguts fins
fins al
al moment
moment En
En el
el funcionament
funcionament de
de les
les xarxes
xarxes neurals
neurals diferenciem
diferenciem l’etapa
l’etapa d’aprenentatge
d’aprenentatge o
o entrenament
entrenament en
en la
la que
que els
els pesos
pesos de
de les
les neurones
neurones s’ajusten
s’ajusten de
de forma
forma automàtica
automàtica i
i l’etapa
l’etapa de
de simulació
simulació en
en que
que la
la xarxa
xarxa entrenada
entrenada s’utilitza
s’utilitza pel
pel propòsit
propòsit previst
previst Així
Així l’algorisme
l’algorisme de
de “backpropagation”
“backpropagation” és
és un
un dels
dels més
més usats
usats per
per entrenar
entrenar xarxes
xarxes neurals
neurals multicapa
multicapa feedforward
feedforward Entre
Entre les
les aplicacions
aplicacions podem
podem destacar
destacar el
el identificació
identificació de
de caràcters
caràcters manuscrits
manuscrits reconeixement
reconeixement del
del llenguatge
llenguatge natural
natural cares
cares objectes
objectes multitud
multitud d’aplicacions
d’aplicacions En
En aquesta
aquesta pràctica
pràctica aprendrem
aprendrem a
a dissenyar
dissenyar xarxes
xarxes neurals
neurals per
per resoldre
resoldre problemes
problemes concrets
concrets mitjançant
mitjançant l’ús
l’ús de
de les
les llibreries
llibreries Keras
Keras El
El primer
primer que
que caldrà
caldrà fer
fer serà
serà preparar
preparar l
l entorn
entorn per
per poder
poder executar
executar totes
totes les
les comandes
comandes per
per tant
tant carregarem
carregarem les
les llibreries
llibreries adequades
adequades Començarem
Començarem amb
amb llibreries
llibreries ja
ja conegudes
conegudes de
de pràctiques
pràctiques anteriors
anteriors Numpy
Numpy per
per poder
poder treballar
treballar amb
amb vectors
vectors n
n dimensionals
dimensionals fàcilement
fàcilement Pandas
Pandas per
per millorar
millorar la
la manipulació
manipulació de
de dades
dades Matplotlib
Matplotlib per
per fer
fer gràfics
gràfics Seaborn
Seaborn per
per millorar
millorar els
els gràfics
gràfics amb
amb informació
informació estadística
estadística Scikit
Scikit learn
learn per
per les
les seves
seves llibreries
llibreries científiques
científiques i
i de
de processat
processat de
de dades
dades In
In Manipulacio
Manipulacio de
de dades
dades import
import numpy
numpy as
as np
np import
import pandas
pandas as
as pd
pd Plots
Plots import
import matplotlib
matplotlib pyplot
pyplot as
as plt
plt import
import seaborn
seaborn as
as sns
sns Pre
Pre processat
processat de
de dades
dades from
from sklearn
sklearn model
model selection
selection import
import train
train test
test split
split Les
Les llibreries
llibreries noves
noves que
que farem
farem servir
servir per
per treballar
treballar amb
amb xarxes
xarxes neuronals
neuronals s’anomenen
s’anomenen Keras
Keras Keras
Keras van
van ser
ser desenvolupades
desenvolupades inicialment
inicialment com
com a
a part
part del
del projecte
projecte ONEIROS
ONEIROS Open
Open ended
ended Neuro
Neuro Electronic
Electronic Intelligent
Intelligent Robot
Robot Operating
Operating System
System per
per un
un enginyer
enginyer de
de Google
Google i
i va
va acabant
acabant ser
ser una
una capa
capa o
o interfície
interfície d
d alt
alt nivell
nivell per
per crear
crear xarxes
xarxes neurals
neurals de
de forma
forma simple
simple amb
amb altres
altres llibreries
llibreries més
més potents
potents i
i de
de baix
baix nivell
nivell per
per a
a computació
computació numèrica
numèrica com
com Theano
Theano i
i TensorFlow
TensorFlow Piràmide
Piràmide de
de llibreries
llibreries Qualsevol
Qualsevol de
de les
les tres
tres llibreries
llibreries que
que acabem
acabem de
de mencionar
mencionar poden
poden ser
ser utilitzades
utilitzades com
com a
a mitjà
mitjà per
per crear
crear un
un algorisme
algorisme de
de Deep
Deep Learning
Learning En
En el
el nostre
nostre cas
cas per
per simplificar
simplificar la
la pràctica
pràctica farem
farem servir
servir directament
directament Keras
Keras amb
amb la
la implementació
implementació de
de baix
baix nivell
nivell basada
basada en
en TensorFlow
TensorFlow que
que és
és la
la que
que ve
ve per
per defecte
defecte amb
amb l
l entorn
entorn WinPython
WinPython de
de la
la pràctica
pràctica De
De les
les llibreries
llibreries de
de Keras
Keras necessitarem
necessitarem exactament
exactament Sequential
Sequential model
model per
per a
a xarxes
xarxes neuronals
neuronals on
on les
les capes
capes s
s organitzen
organitzen com
com una
una llista
llista seqüencial
seqüencial Dense
Dense Activation
Activation i
i Dropout
Dropout diferents
diferents tipus
tipus de
de capes
capes per
per les
les nostres
nostres xarxes
xarxes Adam
Adam optimitzador
optimitzador de
de pesos
pesos de
de la
la xarxa
xarxa In
In Xarxes
Xarxes neurals
neurals from
from keras
keras models
models import
import Sequential
Sequential from
from keras
keras layers
layers core
core import
import Dense
Dense Dropout
Dropout Activation
Activation from
from keras
keras optimizers
optimizers import
import Adam
Adam El
El primer
primer cop
cop en
en executar
executar aquestes
aquestes comandes
comandes mostrara
mostrara un
un missatge
missatge de
de qui
qui backen
backen d
d fa
fa servir
servir Classificació
Classificació d
d una
una XOR¶
XOR¶ Inicialment
Inicialment les
les xarxes
xarxes neuronals
neuronals no
no van
van ser
ser gaire
gaire utilitzades
utilitzades degut
degut a
a que
que el
el màxim
màxim exponent
exponent era
era el
el perceptró
perceptró simple
simple El
El perceptró
perceptró tenia
tenia el
el problema
problema de
de que
que només
només era
era capaç
capaç de
de classificar
classificar problemes
problemes linealment
linealment separables
separables és
és a
a dir
dir on
on les
les classes
classes poden
poden ser
ser separades
separades amb
amb una
una recta
recta sense
sense importar
importar com
com de
de complexa
complexa sigui
sigui la
la funció
funció d
d aquesta
aquesta recta
recta Intentem
Intentem resoldre
resoldre per
per exemple
exemple la
la funció
funció XOR
XOR OR
OR exclusiva
exclusiva fent
fent servir
servir un
un perceptró
perceptró simple
simple La
La taula
taula de
de la
la veritat
veritat de
de la
la XOR
XOR és
és la
la següent
següent X
X 0
0 X
X 1
1 Sortida
Sortida y
y 0
0 0
0 0
0 0
0 1
1 1
1 1
1 0
0 1
1 1
1 1
1 0
0 Per
Per tant
tant carreguem
carreguem aquestes
aquestes dades
dades com
com matrius
matrius i
i vectors
vectors In
In Entrada
Entrada bidimensional
bidimensional X
X X
X np
np array
array 0
0 0
0 0
0 1
1 1
1 0
0 1
1 1
1 Entrada
Entrada unidimensional
unidimensional y
y y
y np
np array
array 0
0 1
1 1
1 0
0 Ara
Ara crearem
crearem un
un model
model de
de xarxa
xarxa neuronal
neuronal mitjançant
mitjançant Keras
Keras Les
Les xarxes
xarxes neuronals
neuronals clàssiques
clàssiques on
on cada
cada capa
capa està
està connectada
connectada amb
amb la
la capa
capa anterior
anterior i
i la
la següent
següent equivalen
equivalen a
a la
la classe
classe Sequential
Sequential de
de Keras
Keras Aquests
Aquests models
models seqüencials
seqüencials estan
estan buits
buits i
i requereixen
requereixen que
que afegim
afegim les
les capes
capes necessàries
necessàries Farem
Farem servir
servir la
la classe
classe Dense
Dense que
que representa
representa una
una capa
capa de
de neurones
neurones on
on totes
totes les
les entrades
entrades i
i sortides
sortides estan
estan connectades
connectades Concretament
Concretament especificarem
especificarem que
que només
només volem
volem una
una neurona
neurona el
el perceptró
perceptró i
i que
que aquest
aquest perceptró
perceptró te
te dues
dues entrades
entrades input
input dim
dim 2
2 Després
Després caldrà
caldrà afegir
afegir una
una activació
activació per
per a
a aquesta
aquesta capa
capa i
i ho
ho farem
farem amb
amb la
la classe
classe Activation
Activation on
on especificarem
especificarem que
que volem
volem que
que la
la activació
activació sigui
sigui del
del tipus
tipus sigmoïdal
sigmoïdal sigmodid
sigmodid Si
Si intentem
intentem buscar
buscar equivalències
equivalències entre
entre aquest
aquest model
model i
i la
la següent
següent figura
figura tenim
tenim dues
dues entrades
entrades X
X 0
0 i
i X
X 1
1 input
input dim
dim 2
2 que
que van
van a
a parar
parar a
a una
una neurona
neurona que
que representa
representa el
el perceptró
perceptró Dense
Dense 1
1 i
i aquesta
aquesta neurona
neurona te
te una
una activació
activació sigmoïdal
sigmoïdal Activation
Activation sigmoid
sigmoid Esquema
Esquema de
de perceptró
perceptró de
de dues
dues entrades
entrades Figura
Figura Esquema
Esquema de
de perceptró
perceptró de
de dues
dues entrades
entrades Si
Si considerem
considerem el
el cas
cas de
de la
la funció
funció XOR
XOR amb
amb la
la taula
taula de
de veritat
veritat següent
següent ens
ens trobem
trobem que
que no
no existeix
existeix cap
cap recta
recta que
que sigui
sigui capaç
capaç de
de classificar
classificar tots
tots els
els casos
casos correctament
correctament això
això es
es degut
degut a
a que
que aquesta
aquesta funció
funció no
no es
es linealment
linealment separable
separable In
In model
model Sequential
Sequential model
model add
add Dense
Dense 1
1 input
input dim
dim 2
2 model
model add
add Activation
Activation sigmoid
sigmoid Com
Com hem
hem comentat
comentat abans
abans Keras
Keras és
és una
una llibreria
llibreria que
que fa
fa de
de capa
capa d
d alt
alt nivell
nivell de
de TensorFlow
TensorFlow i
i per
per tant
tant un
un cop
cop hem
hem definit
definit el
el model
model caldrà
caldrà compilar
compilar lo
lo en
en format
format TensorFlow
TensorFlow per
per poder
poder executar
executar lo
lo Això
Això es
es realitza
realitza amb
amb la
la funció
funció compile
compile on
on per
per paràmetres
paràmetres li
li haurem
haurem d
d especificar
especificar quina
quina serà
serà la
la mesura
mesura d
d error
error de
de la
la xarxa
xarxa i
i quin
quin optimitzador
optimitzador farem
farem servir
servir Com
Com a
a mesura
mesura de
de l
l error
error farem
farem servir
servir l’entropia
l’entropia creuada
creuada binaria
binaria binary
binary crossentropy
crossentropy ja
ja que
que tenim
tenim una
una sortida
sortida binaria
binaria i
i aquesta
aquesta mesura
mesura contrasta
contrasta la
la probabilitat
probabilitat una
una determinada
determinada distribució
distribució de
de probabilitats
probabilitats de
de la
la sortida
sortida 80
80 de
de que
que sigui
sigui 1
1 i
i 20
20 de
de que
que sigui
sigui 0
0 amb
amb la
la real
real 100
100 de
de que
que sigui
sigui un
un 1
1 0
0 de
de que
que sigui
sigui 0
0 La
La modificació
modificació de
de pesos
pesos en
en xarxes
xarxes neurals
neurals s
s ha
ha realitzat
realitzat clàssicament
clàssicament mitjançant
mitjançant l
l algorisme
algorisme de
de backpropagation
backpropagation però
però degut
degut a
a que
que Keras
Keras està
està preparat
preparat per
per fer
fer deep
deep learning
learning quan
quan treballem
treballem amb
amb xarxes
xarxes neuronals
neuronals de
de dimensions
dimensions massives
massives aquest
aquest algorisme
algorisme pot
pot ser
ser molt
molt costos
costos computacionalment
computacionalment per
per tant
tant considera
considera que
que cal
cal algun
algun mitjà
mitjà d
d optimització
optimització d
d aquest
aquest procés
procés Les
Les opcions
opcions per
per defecte
defecte són
són variacions
variacions de
de mètodes
mètodes de
de descens
descens de
de gradient
gradient estocàstics
estocàstics i
i en
en aquest
aquest cas
cas farem
farem servir
servir Adam
Adam In
In model
model compile
compile loss
loss binary
binary crossentropy
crossentropy optimizer
optimizer adam
adam metrics
metrics accuracy
accuracy Ara
Ara que
que ja
ja tenim
tenim el
el model
model del
del nostre
nostre perceptró
perceptró el
el podem
podem entrenar
entrenar amb
amb la
la comanda
comanda fit
fit on
on passarem
passarem per
per paràmetre
paràmetre les
les entrades
entrades X
X les
les sortides
sortides y
y que
que faci
faci 1000
1000 iteracions
iteracions per
per corregir
corregir els
els pesos
pesos nb
nb epoch
epoch que
que les
les dades
dades les
les introdueixi
introdueixi en
en l
l optimitzador
optimitzador de
de 4
4 en
en 4
4 batch
batch size
size i
i que
que no
no ens
ens mostri
mostri informació
informació addicional
addicional del
del procés
procés verbose
verbose 0
0 In
In model
model fit
fit X
X y
y batch
batch size
size 4
4 nb
nb epoch
epoch 1000
1000 verbose
verbose 0
0 Un
Un cop
cop entrenada
entrenada la
la nostre
nostre xarxa
xarxa podem
podem avaluar
avaluar la
la i
i veure
veure els
els resultats
resultats amb
amb la
la comanda
comanda evaluate
evaluate In
In score
score model
model evaluate
evaluate X
X y
y print
print Exactitud
Exactitud de
de la
la classificacio
classificacio score
score 1
1 Com
Com podeu
podeu veure
veure no
no hem
hem aconseguit
aconseguit una
una classificació
classificació amb
amb el
el 100
100 d
d encerts
encerts Pregunta
Pregunta Quina
Quina avaluació
avaluació heu
heu obtingut
obtingut Comenteu
Comenteu que
que pot
pot estar
estar passant
passant Feu
Feu servir
servir les
les gràfiques
gràfiques generades
generades amb
amb les
les comandes
comandes següents
següents per
per ajudar
ajudar vos
vos In
In plt
plt figure
figure figsize
figsize 12
12 6
6 plt
plt subplot
subplot 1
1 2
2 1
1 plt
plt scatter
scatter X
X 0
0 X
X 1
1 marker
marker o
o c
c y
y plt
plt title
title Entrades
Entrades amb
amb classes
classes reals
reals plt
plt subplot
subplot 1
1 2
2 2
2 plt
plt scatter
scatter X
X 0
0 X
X 1
1 marker
marker o
o c
c model
model predict
predict classes
classes X
X plt
plt title
title Entrades
Entrades amb
amb classes
classes predites
predites x
x min
min x
x max
max X
X 0
0 min
min 0
0 5
5 X
X 0
0 max
max 0
0 5
5 y
y min
min y
y max
max X
X 1
1 min
min 0
0 5
5 X
X 1
1 max
max 0
0 5
5 xx
xx yy
yy np
np meshgrid
meshgrid np
np arange
arange x
x min
min x
x max
max 0
0 01
01 np
np arange
arange y
y min
min y
y max
max 0
0 01
01 Z
Z model
model predict
predict classes
classes np
np c
c xx
xx ravel
ravel yy
yy ravel
ravel verbose
verbose 0
0 Z
Z Z
Z reshape
reshape xx
xx shape
shape plt
plt figure
figure figsize
figsize 6
6 6
6 plt
plt contourf
contourf xx
xx yy
yy Z
Z alpha
alpha 0
0 4
4 plt
plt scatter
scatter X
X 0
0 X
X 1
1 c
c y
y alpha
alpha 0
0 8
8 plt
plt title
title Classes
Classes reals
reals amb
amb la
la recta
recta de
de decisió
decisió Si
Si volem
volem classificar
classificar perfectament
perfectament les
les entrades
entrades d
d una
una funció
funció XOR
XOR necessitarem
necessitarem un
un perceptró
perceptró multicapa
multicapa Les
Les següents
següents comandes
comandes en
en creant
creant un
un In
In model
model Sequential
Sequential model
model add
add Dense
Dense 5
5 input
input dim
dim 2
2 model
model add
add Activation
Activation sigmoid
sigmoid model
model add
add Dense
Dense 10
10 model
model add
add Activation
Activation sigmoid
sigmoid model
model add
add Dense
Dense 1
1 model
model add
add Activation
Activation sigmoid
sigmoid Pregunta
Pregunta Descriu
Descriu l
l estructura
estructura de
de xarxa
xarxa neuronal
neuronal creant
creant les
les comandes
comandes anteriors
anteriors També
També dibuixa
dibuixa la
la fent
fent servir
servir com
com a
a guia
guia l’esquema
l’esquema de
de perceptró
perceptró de
de dues
dues entrades
entrades mostrat
mostrat anteriorment
anteriorment Si
Si compilem
compilem el
el nou
nou model
model l
l entrenem
entrenem i
i l’avaluem
l’avaluem ara
ara hauríem
hauríem d
d obtenir
obtenir una
una exactitud
exactitud del
del 100
100 In
In model
model compile
compile loss
loss binary
binary crossentropy
crossentropy optimizer
optimizer adam
adam metrics
metrics accuracy
accuracy model
model fit
fit X
X y
y batch
batch size
size 4
4 nb
nb epoch
epoch 10000
10000 verbose
verbose 0
0 score
score model
model evaluate
evaluate X
X y
y print
print Exactitud
Exactitud de
de la
la classificacio
classificacio score
score 1
1 Pregunta
Pregunta Feu
Feu servir
servir les
les gràfiques
gràfiques generades
generades amb
amb les
les comandes
comandes següents
següents per
per comentar
comentar perquè
perquè la
la classificació
classificació ara
ara si
si és
és correcte
correcte In
In plt
plt figure
figure figsize
figsize 12
12 6
6 plt
plt subplot
subplot 1
1 2
2 1
1 plt
plt scatter
scatter X
X 0
0 X
X 1
1 marker
marker o
o c
c y
y plt
plt title
title Entrades
Entrades amb
amb classes
classes reals
reals plt
plt subplot
subplot 1
1 2
2 2
2 plt
plt scatter
scatter X
X 0
0 X
X 1
1 marker
marker o
o c
c model
model predict
predict classes
classes X
X plt
plt title
title Entrades
Entrades amb
amb classes
classes predites
predites x
x min
min x
x max
max X
X 0
0 min
min 0
0 5
5 X
X 0
0 max
max 0
0 5
5 y
y min
min y
y max
max X
X 1
1 min
min 0
0 5
5 X
X 1
1 max
max 0
0 5
5 xx
xx yy
yy np
np meshgrid
meshgrid np
np arange
arange x
x min
min x
x max
max 0
0 01
01 np
np arange
arange y
y min
min y
y max
max 0
0 01
01 Z
Z model
model predict
predict classes
classes np
np c
c xx
xx ravel
ravel yy
yy ravel
ravel verbose
verbose 0
0 Z
Z Z
Z reshape
reshape xx
xx shape
shape plt
plt figure
figure figsize
figsize 6
6 6
6 plt
plt contourf
contourf xx
xx yy
yy Z
Z alpha
alpha 0
0 4
4 plt
plt scatter
scatter X
X 0
0 X
X 1
1 c
c y
y alpha
alpha 0
0 8
8 plt
plt title
title Classes
Classes reals
reals amb
amb la
la recta
recta de
de decisió
decisió Resistència
Resistència a
a la
la compressió
compressió del
del formigó¶
formigó¶ Les
Les xarxes
xarxes neurals
neurals no
no només
només es
es poden
poden fer
fer servir
servir en
en problemes
problemes de
de classificació
classificació Si
Si a
a la
la xarxa
xarxa neural
neural no
no li
li posem
posem una
una funció
funció d
d activació
activació i
i fem
fem servir
servir directament
directament l
l agregació
agregació de
de les
les entrades
entrades de
de l
l ultima
ultima neurona
neurona ponderada
ponderada amb
amb els
els pesos
pesos de
de les
les connexions
connexions podem
podem fer
fer la
la servir
servir com
com a
a sistema
sistema de
de regressió
regressió per
per predir
predir valors
valors d
d una
una variable
variable real
real Per
Per al
al següent
següent exercici
exercici farem
farem servir
servir un
un dataset
dataset del
del repositori
repositori de
de la
la UCI
UCI Machine
Machine Learning
Learning Repository
Repository concretament
concretament el
el de
de força
força compressiva
compressiva del
del formigó
formigó El
El formigó
formigó és
és el
el material
material més
més important
important de
de la
la construcció
construcció a
a tot
tot el
el món
món El
El problema
problema es
es que
que la
la resistència
resistència a
a la
la compressió
compressió d’aquest
d’aquest material
material és
és una
una funció
funció no
no linear
linear que
que depèn
depèn de
de molts
molts factors
factors entre
entre d
d altres
altres de
de la
la seva
seva edat
edat i
i els
els ingredients
ingredients que
que es
es fan
fan servir
servir per
per crear
crear lo
lo Els
Els ingredients
ingredients principals
principals solen
solen ser
ser el
el ciment
ciment escòria
escòria d
d alt
alt forn
forn cendres
cendres aigua
aigua superplastificant
superplastificant i
i àrids
àrids La
La descripció
descripció del
del dataset
dataset ens
ens explica
explica que
que les
les dades
dades són
són part
part d
d un
un estudi
estudi en
en condicions
condicions de
de laboratori
laboratori de
de la
la resistència
resistència compressiva
compressiva de
de formigó
formigó en
en MegaPascals
MegaPascals MPa
MPa on
on s
s han
han creat
creat certes
certes barreges
barreges d
d ingredients
ingredients i
i temps
temps de
de curació
curació Concretament
Concretament ens
ens trobem
trobem amb
amb 1030
1030 casos
casos diferents
diferents composats
composats per
per 8
8 variables
variables qualitatives
qualitatives representant
representant les
les quantitats
quantitats de
de cada
cada ingredient
ingredient i
i el
el temps
temps de
de curació
curació de
de la
la mescla
mescla i
i la
la variable
variable de
de sortida
sortida representant
representant ela
ela pressió
pressió de
de fallida
fallida Primer
Primer de
de tot
tot fem
fem servir
servir pandas
pandas per
per carregar
carregar les
les dades
dades i
i descriure
descriure les
les In
In formigo
formigo pd
pd read
read csv
csv Concrete
Concrete csv
csv formigo
formigo describe
describe Per
Per comprovar
comprovar l
l eficàcia
eficàcia de
de les
les xarxes
xarxes neuronals
neuronals en
en aquest
aquest domini
domini el
el primer
primer que
que haurem
haurem de
de fer
fer serà
serà separar
separar els
els casos
casos que
que tenim
tenim en
en dos
dos conjunts
conjunts un
un per
per entrenar
entrenar i
i un
un per
per comprovar
comprovar Ho
Ho farem
farem mitjanant
mitjanant la
la funció
funció train
train test
test split
split de
de les
les llibreries
llibreries de
de Scikit
Scikit learn
learn In
In Per
Per cada
cada cas
cas separem
separem els
els atributs
atributs referents
referents a
a ingredients
ingredients i
i temps
temps de
de l
l atribut
atribut objectiu
objectiu a
a predir
predir X
X formigo
formigo iloc
iloc 1
1 values
values y
y formigo
formigo iloc
iloc 1
1 values
values Fem
Fem la
la divisio
divisio de
de train
train test
test entrades
entrades train
train entrades
entrades test
test classes
classes train
train classes
classes test
test train
train test
test split
split X
X y
y train
train size
size 0
0 75
75 De
De la
la descripció
descripció del
del dataset
dataset ja
ja se’ns
se’ns ha
ha comentat
comentat que
que es
es tracta
tracta d
d un
un problema
problema no
no lineal
lineal per
per tant
tant necessitarem
necessitarem una
una xarxa
xarxa neuronal
neuronal amb
amb perceptrons
perceptrons multicapa
multicapa com
com a
a mínim
mínim de
de tres
tres capes
capes Existeix
Existeix la
la tendència
tendència actual
actual d
d anomenar
anomenar les
les xarxes
xarxes neuronals
neuronals de
de més
més de
de tres
tres capes
capes o
o més
més com
com a
a Deep
Deep Neural
Neural Networks
Networks degut
degut a
a que
que son
son capces
capces de
de solucionar
solucionar problemes
problemes n
n dimensionals
dimensionals però
però sense
sense poder
poder donar
donar una
una explicació
explicació analítica
analítica dels
dels resultats
resultats degut
degut a
a la
la perspectiva
perspectiva subsimbólica
subsimbólica la
la xarxa
xarxa neuronal
neuronal que
que implementarem
implementarem està
està descrita
descrita a
a les
les següents
següents línies
línies de
de codi
codi Recordem
Recordem que
que per
per fer
fer regressió
regressió cal
cal que
que no
no hi
hi hagi
hagi una
una funció
funció d
d activació
activació a
a la
la ultima
ultima capa
capa Per
Per millorar
millorar els
els resultats
resultats introduirem
introduirem dos
dos nous
nous tipus
tipus de
de d
d activacions
activacions capes
capes Activació
Activació Relu
Relu i
i capa
capa Dropout
Dropout Relu
Relu es
es una
una funció
funció d
d activació
activació que
que serveix
serveix com
com a
a rectificador
rectificador ja
ja que
que força
força que
que tots
tots els
els valors
valors siguin
siguin iguals
iguals o
o superiors
superiors a
a zero
zero d
d aquesta
aquesta forma
forma aquest
aquest valors
valors negatius
negatius no
no es
es propaguen
propaguen cap
cap endavant
endavant Dropout
Dropout és
és un
un tipus
tipus de
de capa
capa que
que no
no realitza
realitza cap
cap funció
funció només
només deixa
deixa passar
passar les
les connexions
connexions endavant
endavant tal
tal i
i com
com entren
entren però
però amb
amb l
l afegit
afegit que
que pot
pot eliminar
eliminar un
un cert
cert percentatge
percentatge de
de les
les connexions
connexions Això
Això es
es fa
fa amb
amb el
el propòsit
propòsit d
d evitar
evitar que
que el
el model
model quedi
quedi sobre
sobre entrenat
entrenat amb
amb les
les dades
dades inicials
inicials i
i després
després no
no sigui
sigui resistent
resistent al
al soroll
soroll Com
Com que
que estem
estem tractant
tractant un
un problema
problema de
de regressió
regressió la
la mesura
mesura que
que farem
farem servir
servir per
per comprovar
comprovar l
l error
error de
de la
la xarxa
xarxa neural
neural serà
serà l
l error
error quadràtic
quadràtic mitjà
mitjà o
o MSE
MSE In
In Model
Model sequencial
sequencial model
model Sequential
Sequential Primera
Primera capa
capa densa
densa de
de 128
128 neurones
neurones amb
amb 8
8 entrades
entrades model
model add
add Dense
Dense 128
128 input
input dim
dim 8
8 Afegim
Afegim una
una activacio
activacio rectificadora
rectificadora relu
relu per
per eliminar
eliminar valors
valors inferiors
inferiors a
a 0
0 model
model add
add Activation
Activation relu
relu Eliminem
Eliminem el
el 20
20 de
de les
les conexions
conexions seguents
seguents per
per evitar
evitar sobreentrenament
sobreentrenament model
model add
add Dropout
Dropout 0
0 2
2 Afegim
Afegim una
una funcio
funcio d
d activacio
activacio sigmoidal
sigmoidal model
model add
add Activation
Activation sigmoid
sigmoid Segona
Segona capa
capa capa
capa oculata
oculata densa
densa de
de 64
64 neurones
neurones amb
amb activacio
activacio sigmoidal
sigmoidal model
model add
add Dense
Dense 64
64 model
model add
add Activation
Activation sigmoid
sigmoid Tercera
Tercera capa
capa capa
capa oculata
oculata densa
densa de
de 64
64 neurones
neurones amb
amb activacio
activacio sigmoidal
sigmoidal model
model add
add Dense
Dense 64
64 model
model add
add Activation
Activation sigmoid
sigmoid Capa
Capa de
de sortida
sortida densa
densa amb
amb una
una unica
unica neurona
neurona i
i sense
sense activació
activació model
model add
add Dense
Dense 1
1 Compilem
Compilem el
el model
model model
model compile
compile loss
loss mse
mse optimizer
optimizer adam
adam Amb
Amb les
les dades
dades d
d entrenament
entrenament calculem
calculem els
els pesos
pesos de
de la
la xarxa
xarxa model
model fit
fit entrades
entrades train
train classes
classes train
train nb
nb epoch
epoch 10
10 verbose
verbose 0
0 Avaluem
Avaluem el
el model
model amb
amb les
les dades
dades de
de test
test score
score model
model evaluate
evaluate entrades
entrades test
test classes
classes test
test verbose
verbose 0
0 print
print Test
Test score
score MSE
MSE score
score Fem
Fem un
un grafic
grafic amb
amb els
els resultats
resultats plt
plt figure
figure figsize
figsize 16
16 8
8 plt
plt plot
plot classes
classes test
test label
label Real
Real plt
plt plot
plot model
model predict
predict entrades
entrades test
test label
label Prediccio
Prediccio plt
plt legend
legend bbox
bbox to
to anchor
anchor 1
1 05
05 1
1 loc
loc 2
2 borderaxespad
borderaxespad 0
0 plt
plt title
title Valors
Valors reals
reals i
i predits
predits de
de la
la MPa
MPa Els
Els resultats
resultats de
de l
l avaluació
avaluació no
no semblen
semblen gaire
gaire bons
bons Probablement
Probablement deu
deu ser
ser que
que no
no hem
hem fet
fet servir
servir suficients
suficients iteracions
iteracions en
en el
el procés
procés d
d entrenament
entrenament Pregunta
Pregunta Modifica
Modifica el
el número
número d
d iteracions
iteracions en
en l
l entrenament
entrenament dels
dels pesos
pesos de
de la
la xarxa
xarxa fins
fins que
que obtinguis
obtinguis un
un resultat
resultat que
que creguis
creguis acceptables
acceptables Guarda
Guarda els
els valors
valors resultants
resultants de
de la
la puntuació
puntuació MSE
MSE i
i fes
fes un
un gràfic
gràfic amb
amb ells
ells per
per veure
veure l
l evolució
evolució de
de l
l error
error Identificació
Identificació d
d imatges¶
imatges¶ L
L exercici
exercici final
final que
que realitzarem
realitzarem consistirà
consistirà en
en crear
crear un
un sistema
sistema capaç
capaç de
de reconèixer
reconèixer dígits
dígits escrits
escrits a
a má
má Keras
Keras facilita
facilita la
la descarrega
descarrega d
d un
un conjunt
conjunt de
de 60000
60000 imatges
imatges de
de 28x28
28x28 píxels
píxels anomenat
anomenat MNIST
MNIST Aquest
Aquest dataset
dataset d
d imatges
imatges es
es fa
fa servir
servir des
des del
del 1995
1995 com
com a
a conjunt
conjunt de
de proves
proves en
en algorismes
algorismes de
de machine
machine learning
learning per
per comprovar
comprovar l
l eficàcia
eficàcia d
d experiments
experiments Com
Com que
que cada
cada imatge
imatge representarà
representarà un
un dígit
dígit tindrem
tindrem en
en les
les nostres
nostres mans
mans un
un problema
problema de
de classificació
classificació multi
multi classe
classe concretament
concretament 10
10 classes
classes 0
0 1
1 2
2 3
3 4
4 5
5 6
6 7
7 8
8 i
i 9
9 Procedim
Procedim a
a carregar
carregar el
el dataset
dataset El
El primer
primer cop
cop pot
pot trigar
trigar degut
degut a
a que
que cal
cal descarregar
descarregar les
les dades
dades In
In Definim
Definim el
el numero
numero de
de classes
classes amb
amb les
les que
que treballarem
treballarem nb
nb classes
classes 10
10 Per
Per simplicitat
simplicitat les
les dades
dades ja
ja venen
venen carregades
carregades en
en format
format test
test i
i train
train from
from keras
keras datasets
datasets import
import mnist
mnist X
X train
train y
y train
train X
X test
test y
y test
test mnist
mnist load
load data
data print
print Estructura
Estructura original
original de
de X
X train
train X
X train
train shape
shape print
print Estructura
Estructura original
original de
de y
y train
train y
y train
train shape
shape Ara
Ara que
que ja
ja tenim
tenim les
les dades
dades donem
donem un
un cop
cop d
d ull
ull a
a les
les imatges
imatges per
per veure
veure com
com són
són In
In Indiquem
Indiquem a
a les
les llibreries
llibreries Seaborn
Seaborn que
que no
no volem
volem la
la graella
graella a
a les
les grafiques
grafiques sns
sns set
set style
style whitegrid
whitegrid axes
axes grid
grid False
False for
for i
i in
in range
range 9
9 plt
plt subplot
subplot 3
3 3
3 i
i 1
1 plt
plt imshow
imshow X
X train
train i
i cmap
cmap gray
gray interpolation
interpolation none
none plt
plt title
title Classe
Classe format
format y
y train
train i
i Podem
Podem veure
veure com
com les
les imatges
imatges tenen
tenen un
un fons
fons negre
negre i
i els
els números
números estan
estan representats
representats en
en blanc
blanc El
El següent
següent pas
pas serà
serà preparar
preparar les
les dades
dades per
per a
a que
que tinguin
tinguin el
el format
format correcte
correcte Com
Com que
que les
les nostres
nostres dades
dades d
d entrada
entrada son
son imatges
imatges però
però les
les xarxes
xarxes neurals
neurals nomes
nomes accepten
accepten vectors
vectors haurem
haurem de
de transformar
transformar cada
cada imatge
imatge de
de 28x28
28x28 en
en un
un vector
vector de
de 784
784 A
A més
més a
a més
més els
els píxels
píxels de
de les
les imatges
imatges solen
solen tenir
tenir un
un valor
valor en
en el
el rang
rang 0
0 255
255 i
i per
per simplificar
simplificar podem
podem escalar
escalar lo
lo al
al rang
rang 0
0 1
1 In
In Reshape
Reshape X
X train
train X
X train
train reshape
reshape 60000
60000 784
784 X
X test
test X
X test
test reshape
reshape 10000
10000 784
784 Canvi
Canvi de
de tipus
tipus de
de dada
dada X
X train
train X
X train
train astype
astype float32
float32 X
X test
test X
X test
test astype
astype float32
float32 Reescalat
Reescalat X
X train
train 255
255 X
X test
test 255
255 print
print Estructura
Estructura de
de la
la matriu
matriu d
d entrenament
entrenament X
X train
train shape
shape print
print Estructura
Estructura de
de la
la matriu
matriu de
de proves
proves X
X test
test shape
shape Com
Com que
que tenim
tenim un
un problema
problema de
de classificació
classificació multi
multi classe
classe caldrà
caldrà codificar
codificar les
les sortides
sortides de
de la
la xarxa
xarxa neuronal
neuronal Una
Una aproximació
aproximació potser
potser fer
fer servir
servir el
el format
format one
one hot
hot on
on tindrem
tindrem 10
10 sortides
sortides binaries
binaries a
a la
la nostre
nostre xarxa
xarxa però
però només
només s
s activarà
activarà la
la que
que indiqui
indiqui la
la classe
classe correcte
correcte Per
Per exemple
exemple 0
0 1
1 0
0 0
0 0
0 0
0 0
0 0
0 0
0 0
0 1
1 0
0 1
1 0
0 0
0 0
0 0
0 0
0 0
0 0
0 2
2 0
0 0
0 1
1 0
0 0
0 0
0 0
0 0
0 0
0 etc
etc In
In from
from keras
keras utils
utils import
import np
np utils
utils Y
Y train
train np
np utils
utils to
to categorical
categorical y
y train
train nb
nb classes
classes Y
Y test
test np
np utils
utils to
to categorical
categorical y
y test
test nb
nb classes
classes Ara
Ara que
que ja
ja tenim
tenim les
les entrades
entrades i
i les
les sortides
sortides en
en el
el format
format correcte
correcte podem
podem començar
començar a
a definir
definir l
l estructura
estructura de
de la
la nostre
nostre xarxa
xarxa neural
neural Continuarem
Continuarem fent
fent servir
servir un
un model
model Sequential
Sequential amb
amb dues
dues capes
capes ocultes
ocultes de
de 512
512 neurones
neurones amb
amb un
un Dropout
Dropout del
del 20
20 de
de les
les connexions
connexions i
i una
una activació
activació del
del tipus
tipus Relu
Relu La
La capa
capa de
de sortida
sortida consistirà
consistirà de
de 10
10 neurones
neurones una
una per
per cada
cada categoria
categoria a
a classificar
classificar amb
amb una
una activació
activació Softmax
Softmax una
una generalització
generalització de
de la
la funció
funció logística
logística In
In Model
Model sequencial
sequencial model
model Sequential
Sequential Primera
Primera capa
capa de
de 512
512 neurones
neurones amb
amb 784
784 entrades
entrades model
model add
add Dense
Dense 512
512 input
input dim
dim 784
784 Activacio
Activacio relu
relu model
model add
add Activation
Activation relu
relu Eliminem
Eliminem el
el 20
20 de
de les
les connexions
connexions model
model add
add Dropout
Dropout 0
0 2
2 Segona
Segona capa
capa de
de 512
512 neurones
neurones model
model add
add Dense
Dense 512
512 Activacio
Activacio relu
relu model
model add
add Activation
Activation relu
relu Eliminem
Eliminem el
el 20
20 de
de les
les connexions
connexions model
model add
add Dropout
Dropout 0
0 2
2 Capa
Capa de
de sortida
sortida amb
amb 10
10 neurones
neurones i
i activacio
activacio softmax
softmax model
model add
add Dense
Dense 10
10 model
model add
add Activation
Activation softmax
softmax Procedirem
Procedirem a
a compilar
compilar el
el model
model creat
creat especificant
especificant com
com a
a optimitzador
optimitzador el
el mateix
mateix que
que hem
hem fet
fet servir
servir tota
tota l
l estona
estona Adam
Adam que
que volem
volem veure
veure el
el resultat
resultat en
en forma
forma d
d exactitud
exactitud i
i que
que per
per calcular
calcular l
l error
error faci
faci servir
servir la
la funció
funció d
d entropia
entropia creuada
creuada categòrica
categòrica Com
Com que
que tindrem
tindrem 10
10 prediccions
prediccions de
de distribucions
distribucions de
de probabilitat
probabilitat una
una per
per cada
cada dígit
dígit p
p ex
ex 80
80 de
de probabilitat
probabilitat que
que sigui
sigui un
un 3
3 10
10 de
de que
que sigui
sigui un
un 8
8 2
2 de
de que
que sigui
sigui un
un 9
9 i
i la
la classe
classe que
que farem
farem servir
servir per
per entrenar
entrenar seran
seran distribucions
distribucions perfectes
perfectes 100
100 pel
pel numero
numero que
que toca
toca 0
0 la
la resta
resta l
l entropia
entropia creuada
creuada categòrica
categòrica servirà
servirà per
per diferenciar
diferenciar les
les distribucions
distribucions predites
predites amb
amb les
les indicades
indicades per
per la
la classe
classe In
In model
model compile
compile loss
loss categorical
categorical crossentropy
crossentropy optimizer
optimizer adam
adam metrics
metrics accur
accur acy
acy Finalment
Finalment podem
podem entrenar
entrenar el
el model
model i
i avaluar
avaluar lo
lo Tingueu
Tingueu en
en compte
compte com
com ara
ara només
només estem
estem fent
fent 4
4 iteracions
iteracions per
per corregir
corregir els
els pesos
pesos de
de forma
forma més
més o
o menys
menys ràpida
ràpida Si
Si voleu
voleu podeu
podeu incrementar
incrementar aquest
aquest número
número però
però penseu
penseu que
que amb
amb les
les deep
deep neural
neural networks
networks es
es treballa
treballa amb
amb grans
grans quantitats
quantitats de
de dades
dades ara
ara mateix
mateix entreneu
entreneu amb
amb una
una matriu
matriu de
de 60000
60000 784
784 In
In model
model fit
fit X
X train
train Y
Y train
train batch
batch size
size 128
128 nb
nb epoch
epoch 4
4 verbose
verbose 1
1 Avaluarem
Avaluarem la
la xarxa
xarxa neural
neural com
com hem
hem fet
fet en
en els
els exercicis
exercicis anteriors
anteriors amb
amb les
les dades
dades de
de test
test In
In Mostrem
Mostrem els
els resultats
resultats score
score model
model evaluate
evaluate X
X test
test Y
Y test
test verbose
verbose 0
0 print
print Test
Test entropia
entropia creuada
creuada categorica
categorica score
score 0
0 print
print Test
Test exactitud
exactitud score
score 1
1 Podem
Podem aprofitar
aprofitar per
per generar
generar les
les prediccions
prediccions de
de cada
cada imatge
imatge de
de test
test i
i inspeccionar
inspeccionar els
els resultats
resultats In
In Fem
Fem les
les prediccions
prediccions predicted
predicted classes
classes model
model predict
predict classes
classes X
X test
test Guardar
Guardar els
els indexos
indexos dels
dels correctes
correctes incorrectes
incorrectes correct
correct indices
indices np
np nonzero
nonzero predicted
predicted classes
classes y
y test
test 0
0 incorrect
incorrect indices
indices np
np nonzero
nonzero predicted
predicted classes
classes y
y test
test 0
0 Mostrem
Mostrem exemples
exemples de
de classificacions
classificacions correctes
correctes plt
plt figure
figure for
for i
i correct
correct in
in enumerate
enumerate correct
correct indices
indices 9
9 plt
plt subplot
subplot 3
3 3
3 i
i 1
1 plt
plt imshow
imshow X
X test
test correct
correct reshape
reshape 28
28 28
28 cmap
cmap gray
gray interpolation
interpolation none
none plt
plt title
title Pred
Pred Real
Real format
format predicted
predicted classes
classes correct
correct y
y test
test corre
corre ct
ct Mostrem
Mostrem exemples
exemples de
de classificacions
classificacions incorrectes
incorrectes plt
plt figure
figure for
for i
i incorrect
incorrect in
in enumerate
enumerate incorrect
incorrect indices
indices 9
9 plt
plt subplot
subplot 3
3 3
3 i
i 1
1 plt
plt imshow
imshow X
X test
test incorrect
incorrect reshape
reshape 28
28 28
28 cmap
cmap gray
gray interpolation
interpolation non
non e
e plt
plt title
title Pred
Pred Real
Real format
format predicted
predicted classes
classes incorrect
incorrect y
y test
test inc
inc orrect
orrect Pregunta
Pregunta Comenta
Comenta els
els resultats
resultats obtinguts
obtinguts Ajudat
Ajudat de
de les
les gràfiques
gràfiques generades
generades Pregunta
Pregunta Fen
Fen servir
servir Microsoft
Microsoft Paint
Paint o
o qualsevol
qualsevol altre
altre editor
editor genereu
genereu una
una imatge
imatge de
de 28x28
28x28 amb
amb un
un dígit
dígit i
i guardeu
guardeu lo
lo al
al directori
directori d
d aquest
aquest notebook
notebook amb
amb el
el nom
nom numero
numero png
png Aquest
Aquest bloc
bloc de
de codi
codi carrega
carrega la
la imatge
imatge i
i intenta
intenta predir
predir la
la Intenteu
Intenteu fer
fer exemples
exemples classificacions
classificacions correctes
correctes i
i incorrectes
incorrectes In
In import
import matplotlib
matplotlib image
image as
as img
img image
image np
np dot
dot img
img imread
imread numero
numero png
png 0
0 299
299 0
0 587
587 0
0 114
114 plt
plt imshow
imshow image
image cmap
cmap gray
gray interpolation
interpolation none
none image
image shape
shape plt
plt title
title Prediccio
Prediccio format
format str
str model
model predict
predict classes
classes image
image reshape
reshape 1
1 28
28 2
2 8
8 0
0 Que
Que cal
cal entregar¶
entregar¶ Informe
Informe de
de la
la pràctica
pràctica en
en format
format PDF
PDF amb
amb les
les respostes
respostes d
d aquesta
aquesta llibreta
